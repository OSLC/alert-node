'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.polyunfillWindow = exports.polyfillWindow = undefined;

var _storage = require('../src/storage');

var _urlSearchParams = require('url-search-params');

var _urlSearchParams2 = _interopRequireDefault(_urlSearchParams);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/* eslint-env browser */
var _href = void 0;
var _URL = void 0;

// polyfill missing/incomplete web apis
var polyfillWindow = exports.polyfillWindow = function polyfillWindow() {
  _href = window.location.href;
  Object.defineProperty(window.location, 'href', {
    writable: true,
    value: 'https://app.biz/'
  });
  Object.defineProperty(window.location, 'pathname', {
    writable: true,
    value: '/'
  });
  _URL = window.URL;
  window.URL = function (urlStr) {
    var url = new _URL(urlStr);
    url.searchParams = new _urlSearchParams2.default(url.search);
    return url;
  };
  window.URLSearchParams = _urlSearchParams2.default;
  window.localStorage = (0, _storage.memStorage)();
  // this is fixed in the latest jsdom, but jest has not yet updated the jsdom dependency
  window.origin = window.location.origin;
  Object.defineProperty(MessageEvent.prototype, 'origin', {
    writable: true,
    value: window.origin
  });
  MessageEvent.prototype.origin = window.location.origin;
};

var polyunfillWindow = exports.polyunfillWindow = function polyunfillWindow() {
  delete window.localStorage;
  delete window.URLSearchParams;
  window.URL = _URL;
  window.location.href = _href;
  delete window.origin;
};